# âœ” Usage Examples

### ðŸŒŽ Section Map <!-- {docsify-ignore} -->

- [Docker](#docker)
  - [Run a New Scan With NexPloit-CLI](#run-a-new-scan-with-nexploit-cli)
  - [Re-Run an Existing Scan](#re-run-an-existing-scan)
  - [Extra Headers](#extra-headers)

<hr style="height:2px;background-color:#d1d3d4">

## Docker

### Run a New Scan With NexPloit-CLI

The Docker version of the Repeater comes with a built-in [NexPloit-CLI](nexploit-cli/overview.md)

```yaml
version: '3'
services:
  target.local:
    image: path/image-name
    ports:
      - '3000:3000'

  repeater:
    image: neuralegion/repeater:latest
    restart: always
    environment:
      REPEATER_TOKEN: REPEATER-TOKEN
      REPEATER_AGENT: AGENT-ID

  nexploit:
    depends_on:
      - repeater
      - target.local
    image: neuralegion/repeater:nexploit-cli
    environment:
      REPEATER_TOKEN: REPEATER-TOKEN
      REPEATER_ID: REPEATER-ID
    entrypoint:
      - bash
      - -c
      - >
        sleep 10;
        HARID=$$(nexploit-cli archive:upload --type openapi --token=$$REPEATER_TOKEN /opt/repeater/swagger.yaml);
        echo Your HAR ID is $$HARID;
        SCANID=$$(nexploit-cli scan:run --name='My Scan' --agent=$$REPEATER_ID --archive $$HARID --tests header_security --token $$REPEATER_TOKEN);
        echo Scan started $$SCAN_ID;
        echo Poll for scan results;
        RESULT=$$(nexploit-cli scan:polling --token $$REPEATER_TOKEN --breakpoint=high_issue \
          --interval=10000 --timeout=5min $$SCAN_ID);
        nexploit-cli scan:stop --token=$$REPEATER_TOKEN $$SCAN_ID;
        exit $$RESULT;
```

### Re-Run an Existing Scan

```yaml
version: '3'
services:
  target.local:
    image: path/image-name
    ports:
      - '3000:3000'

  repeater:
    image: neuralegion/repeater:latest
    restart: always
    environment:
      REPEATER_TOKEN: REPEATER-TOKEN
      REPEATER_AGENT: AGENT-ID

  nexploit:
    depends_on:
      - repeater
      - target.local
    image: neuralegion/repeater:latest
    environment:
      REPEATER_TOKEN: REPEATER-TOKEN
      SCAN_PROTOTYPE: 6WL3Gi74xzyc1Pvqz6qEdM # previous scan ID
    entrypoint:
      - bash
      - -c
      - >
        sleep 10;
        SCAN_ID=$$(nexploit-cli scan:retest --token=$$REPEATER_TOKEN $$SCAN_PROTOTYPE);
        echo Scan started $$SCAN_ID;
        echo Poll for scan results;
        RESULT=$$(nexploit-cli scan:polling --token $$REPEATER_TOKEN --breakpoint=high_issue \
          --interval=10000 --timeout=5min $$SCAN_ID);
        nexploit-cli scan:stop --token=$$REPEATER_TOKEN $$SCAN_ID;
        exit $$RESULT;
```

### Extra Headers

The Repeater allows a user to overload extra headers onto the Repeater's requests **LOCALLY**, without the need to set them up in NexPloit's cloud engine. This is done by setting the `REPEATER_HEADERS` environment variable.

For example:

```yaml
version: '3'
services:
  repeater:
    image: neuralegion/repeater:latest
    restart: always
    environment:
      REPEATER_TOKEN: REPEATER-TOKEN
      REPEATER_AGENT: cdf07782-bc6c-486a-b459-e182808faa33
      REPEATER_HEADERS: '{ "my_header": "special token" }'
```

Or as a command line configuration:

```
docker run neuralegion/repeater -e 'REPEATER_HEADERS={"my_header": "special token"}'
```
