# üìÉ Command List

This section contains information on using NexPloit CLI's commands.
See `nexploit-cli --help` for all available options.

### üåé Section Map <!-- {docsify-ignore} -->

- [‚Ñπ Command Language Syntax](#‚Ñπ-command-language-syntax)
- [üèÉ Run a Scan](#üèÉ-run-a-scan)
- [üö® Check Scan status](#üö®-check-scan-status)
- [‚óº Stop a Scan](#‚óº-stop-a-scan)
- [üîÉ Retest a Scan](#üîÉ-retest-a-scan)
- [üì§ Upload an Archive](#üì§-upload-an-archive)
- [üìö Generate an Archive with NexMock](#üìö-generate-an-archive-with-nexmock)
- [üîõ Initialize a Repeater](#üîõ-initialize-a-repeater)

<hr style="height:2px;background-color:#d1d3d4">

## ‚Ñπ Command Language Syntax

NexPloit CLI accepts a wide variety of configuration arguments, you can run `nexploit-cli --help` for a thorough documentation.
Configuration arguments in the command-line must be passed after the program command that NexPloit CLI is executing.

```bash
nexploit-cli command_name required_arg [optional_arg] [options]
```

- Most commands, and some options, have aliases. Aliases are shown in the syntax statement for each command.
- Option names are prefixed with a double dash (--). Option aliases are prefixed with a single dash (-). Arguments are not prefixed. For example:

```bash
nexploit-cli scan:stop --token my-jwt-authentication-token my-scan-id
```

Supporing an array of values for a specific argument, seperated by space.
For example:

```bash
nexploit-cli scan:run \
  --token my-jwt-authentication-token \
  --crawler target-url \
  --param path query body \
  --test default_login_location dom_xss sqli
```

NexPloit CLI provides multiple global options which can affect the behaviour of each command.

| Option                | Description                                                                                                                                                                                                                                           |
| --------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--config=configPath` | Path to the file with configuration. By default, CLI tries to discovery config in package.json in the root directory of your application or the separate file by known name in working dir. For details, see [Configuration files](#../configuration) |
| `--api=proxyUrl`      | NexPloit base URL. Default: `https://nexploit.app/`                                                                                                                                                                                                   |
| `--proxy=proxyUrl`    | SOCKS4 or SOCKS5 url to proxy all traffic                                                                                                                                                                                                             |

Typically, the generated artifact can be given as an argument to the command or specified with the `--archive` option (See [archive:generate](#generate-archive-using-nexmock) for more info).

<hr style="height:2px;background-color:#d1d3d4">

## üèÉ Run a Scan

`nexploit-cli scan:run [options]` starts a new scan with the received configuration.

!> If you don't have enough available engines, the scan will be placed in the queue. The new scan will start as soon as you manually stop another running scan or the current scan is done.

This command allows you to specify one or more of the discovery strategies, for example using the `--crawler` option and/or the generated HAR files, seperately or both at the same time. This means that you can handle client side dynamic content, javascript, etc.

### Options

| Option                                    | Description                                                                                                                                                                                                                                                                      |
| ----------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--token my-jwt-authentication-token`     | The unique identifier used to authenticate a user. It can be issued in your organization dashboard                                                                                                                                                                               |
| `--name=extraHeader`, `-n=extraHeader`    | The name of the scan.                                                                                                                                                                                                                                                            |
| `--archive=archiveID`, `-a=archiveID`     | The Archive ID, which can be received via the [archive:upload](#üì§-upload-an-archive) command.                                                                                                                                                                                      |
| `--crawler=url`, `-c=url`                 | Allows to specify a list of specific urls that should be included during crawler discovery.                                                                                                                                                                                      |
| `--repeater=uuid`                            | Allows to specify a list of repeater UUIDs that should be connected with the scan.                                                                                                                                                                                               |
| `--smart`                                 | Use automatic smart decisions such as: parameter skipping, detection phases, etc. to minimize scan time. When turned off, all the tests will be run on all the parameters, which increases the coverage at the expense of scan time.                                             |
| `--param=path/query/fragment/header/body` | Defines which part of the request to attack (more details [here](/user-guide/scans/new-scan#target-parameter-locations-url-scoping))<br><br>**Note:** This argument can be passed multiple times in the same command<br><br> **Default value:** `--param body query fragment`    |
| `--module=dast/fuzzer`                    | The `dast` module tests for specific scenarios, such as OWASP top 10 and other common scenarios. The `fuzzer` module generates various new scenarios to test for unknown vulnerabilities, providing automated AI guided fuzz-testing.<br><br> **Default value:** `--module dast` |
| `--host-filter=hostOrIp`, `-F=hostOrIp`   | The list of specific hosts that should be included in the scan.                                                                                                                                                                                                                  |
| `--header=extraHeader`, `-H=extraHeader`  | Extra headers to be passed with the Archive file. Also, it can be used to remove a header by providing a name without content, for example: `-H "Host:"`.<br><br> **WARNING**: headers set with this option overide the archive headers and will be set in all the requests      |
| `--test=testName`                         | Allows specifying a list of relevant tests to execute during a scan.<br> For example: `--test default_login_location dom_xss`                                                                                                                                                    |

<hr style="height:2px;background-color:#d1d3d4">

## üö® Check Scan Status

`nexploit-cli scan:polling [options] <scan>` configures an ongoing polling of a scan's status, and helps you follow its progress during CI/CD flows.

After the launch, it will check the scan's status most of the time. If the scan finds at least of one medium severity issue, NexPloit CLI will finish with exit code `50`.

### Arguments

| Argument | Description                                         |
| -------- | :-------------------------------------------------- |
| `<scan>` | The ID of an existing scan which you want to check. |

### Options

| Option                                          | Description                                                                                                                                                                                                                                                       |
| ----------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--token my-jwt-authentication-token`           | The unique identifier used to authenticate a user. It can be issued in your organization dashboard                                                                                                                                                                |
| `--breakpoint=any / medium_issue / high_issue.` | A conditional breakpoint that allows to finish the process with exit code `50` only after fulfilling the predefined condition.<br><br> **Default value:** `--breakpoint any`                                                                                      |
| `--interval=milliseconds.`                      | The period of time between the end of a timeout period or completion of a scan status request, and the next request for status. Eg: 60, "2min", "10h", "7d". A numeric value is interpreted as a milliseconds count.<br><br> **Default value:** `--interval 5000` |
| `--timeout=milliseconds.`                       | The allowed maximum time for a polling to end normally. Eg: 60, "2min", "10h", "7d". A numeric value is interpreted as a milliseconds count.                                                                                                                      |

<hr style="height:2px;background-color:#d1d3d4">

## ‚óº Stop a Scan

`nexploit-cli scan:stop [options] <scan id>` stops a scan by id.

### Arguments

| Argument    | Description                                        |
| ----------- | :------------------------------------------------- |
| `<scan id>` | The ID of an existing scan which you want to stop. |

### Options

| Option                                | Description                                                                                        |
| ------------------------------------- | :------------------------------------------------------------------------------------------------- |
| `--token my-jwt-authentication-token` | The unique identifier used to authenticate a user. It can be issued in your organization dashboard |

<hr style="height:2px;background-color:#d1d3d4">

## üîÉ Retest a Scan

`nexploit-cli scan:retest [options] <scan id>` re-run a scan by ID, using the same configuration.

### Arguments

| Argument    | Description                                          |
| ----------- | :--------------------------------------------------- |
| `<scan id>` | The ID of an existing scan which you want to re-run. |

### Options

| Option                                | Description                                                                                         |
| ------------------------------------- | :-------------------------------------------------------------------------------------------------- |
| `--token my-jwt-authentication-token` | The unique identifier used to authenticate a user that can be issued in your organization dashboard |

<hr style="height:2px;background-color:#d1d3d4">

## üì§ Upload an Archive

`nexploit-cli archive:upload [options] <file>` uploads a [HAR](<https://en.wikipedia.org/wiki/HAR_(file_format)>) or [OAS](https://en.wikipedia.org/wiki/OpenAPI_Specification) file to your [NeuraLegion Storage](/user-guide/storage/overview.md).

!> If you plan to run a scan using an OAS file, you must specify a different discovery option by setting the `--discovery` to `oas`.

The command will output the `ID` of a new archive, which you can use to run a new scan.

!> If the archive with that name already exists, you'll receive the following error message: `The file with that name already exists or the HAR file is corrupted.`

### Arguments

| Argument | Description                                                                                                                                                                                                                                                                                                                                                                                                                 |
| -------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `<file>` | A collection of your app http/websockets logs exported into a HAR file. Typically, you can use any browser's dev tools, NeuraLegion's [browser extension](https://chrome.google.com/webstore/detail/nexploit/pgmogkjcjlgjnconlkocehfadbkimjbg) or [Cypress plugin](https://www.npmjs.com/package/@neuralegion/cypress-har-generator) to generate them. In addition, you can use an OAS file that describes your public API. |

### Options

| Option                                     | Description                                                                                                                                                                                                                                                                     |
| ------------------------------------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `--token my-jwt-authentication-token`      | The unique identifier used to authenticate a user. It can be issued in your organization dashboard                                                                                                                                                                              |
| `--type=har/openapi/postman`               | The specification type. Helps determine the best way to parse passed files.<br><br> **Default value:** `--type har`                                                                                                                                                             |
| `--discard=false/true`, `-d=false/true`    | When `true`, removes an archive from the cloud storage after the scan is finished running<br><br> **Default value:** `--discard true`                                                                                                                                           |
| `--header=extraHeader`, `-H=extraHeader`   | Extra headers to be passed with the OAS/Postman file. Also, it can be used to remove a header by providing a name without content, for example: `-H "Host:"` <br><br>**WARNING**: headers set with this option override the archive headers and will be set in all the requests |
| `--variable=envVariable`, `-V=envVariable` | Environment variables to be passed with the Postman file                                                                                                                                                                                                                        |

<hr style="height:2px;background-color:#d1d3d4">

## üìö Generate an Archive with NexMock

`nexploit-cli archive:generate [options] <mockfile>` creates HTTP Archive (HAR) files from mock requests generated by
unit-testing and other local automations. The mock requests are converted into real requests and sent to the target to get real responses. Both requests and responses are saved in a HAR format (see example below).

Supports the latest [NexMock](https://www.npmjs.com/package/@neuralegion/nexmock) API and provides additional features to help you generate HAR files during CI/CD workflows with ease.

In addition, this command has the ability to split NexMock file into multiply HAR files. For this purpose, you can specify the `--split` option, which accepts the number of pieces to split into.

For example:

```bash
nexploit-cli archive:generate \
  --output archive.har \
  --target url-tested-application \
  --header "Authorization: Bearer my-jwt-authentication-token" \
  --split 4 \
  .nexmock
```

The command above will create 4 .HAR files which comply with following pattern: `<basename>(_<number>)?.<extension>`.
E.g. `archive.har`, `archive_2.har`, etc.

#### Arguments

| Argument     | Description                                                                                                                                               |
| ------------ | :-------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `<mockfile>` | A NexMock file is obtained from the NexMock Reporters. See [E2E Guide](https://github.com/NeuraLegion/nexploit-cli/wiki/End-to-End-Guide#karma-or-mocha). |

### Options

| Option                                         | Description                                                                                                                                                                                                                                                                  |
| ---------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--output=newArchivePath`, `-f=newArchivePath` | The path where the new archives will be created, relative to the new workspace root.                                                                                                                                                                                         |
| `--target=hostnameOrIp`, `-T=hostnameOrIp`     | The target hostname or IP address.                                                                                                                                                                                                                                           |
| `--header=extraHeader`, `-H=extraHeader`       | Extra headers to be passed with the NexMock file. Also, it can be used to remove a header by providing a name without content, for example: `-H "Host:"`. <br><br> **WARNING**: headers set with this option overide the archive headers and will be set in all the requests |
| `--pool=size`, `-p=size`                       | The size of the worker pool. Indicates how many requests NexPloit CLI can performs in parallel.<br><br> **Default value:** `--pool 250`                                                                                                                                      |
| `--timeout=milliseconds`                       | The time to wait for a server to send response headers (and start the response body) before aborting the request.<br><br> **Default value:** `--timeout 5000`                                                                                                                |
| `--split=numberPieces`, `-s=numberPieces`      | The number of the HAR pieces. Allows to split a NexMock file into multiple HAR files.<br><br> **Default value:** `--split 1`                                                                                                                                                 |

<hr style="height:2px;background-color:#d1d3d4">

## üîõ Initialize a Repeater

`nexploit-cli repeater [options]` initializes a local Repeater process. When a scan is connected to such a Repeater, all the scan requests are being pulled from the cloud through the repeater to the local target of the scan.

A Repeater allows you to run NexPloit scans without exposing your ports outside. In addition, it can be useful, if you want to run a local scan without deploying.

For a full explanation about how the Repeater works, go to [Deployment Options > On-Prem Agent (Repeater)](/deployment/repeater)

**Additional features:**

- Allows multiple scans to run through a single Repeater
- Can add headers to the requests locally (authentication cookie, etc.), without exposing them to the cloud

!> **IMPORTANT:** The Repeater requires a working `AUTH_TOKEN` with the scope `agents:write:repeater`

### Options

| Option                                   | Description                                                                                                                                                                                                                                                              |
| ---------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--repeater=repeaterId`                        | The ID of an existing Repeater which you want to use.                                                                                                                                                                                                                       |
| `--token my-jwt-authentication-token`    | The unique identifier used to authenticate a user. It can be issued in your organization dashboard                                                                                                                                                                       |
| `--bus=eventBus`                         | NexPloit Event Bus URL.<br><br> **Default value:** `--bus amqps://amq.nexploit.app:5672`                                                                                                                                                                                 |
| `--header=extraHeader`, `-H=extraHeader` | Extra headers to be passed with each request. Also, it can be used to remove a header by providing a name without content, for example: `-H "Host:"`<br><br> **WARNING**: headers set with this option override the original headers and will be set in all the requests |
| `--headers=json`                         | JSON string which contains header list, which is initially empty and consists of zero or more name and value pairs <br><br> **WARNING**: headers set with this option override the original headers and will be set in all the requests.                                 |
| `--proxy=proxyUrl`                       | SOCKS4 or SOCKS5 url to proxy all traffic                                                                                                                                                                                                                                |

<hr style="height:2px;background-color:#d1d3d4">
